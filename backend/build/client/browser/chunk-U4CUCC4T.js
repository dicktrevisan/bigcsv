import{Ec as D,Fa as h,Fc as b,Ia as v,Oa as c,P as d,Pa as s,Ub as F,V as u,Va as p,Wa as _,Xb as C,Z as f,cb as m,dc as I,eb as g,ib as U,ic as k,jb as S,ta as l}from"./chunk-HWO3VZF3.js";var y=(()=>{let t=class t{constructor(){this.http=u(C)}enviarDimp(o,e){return this.http.post(`http://localhost:3000/alimentador/${e}`,o,{headers:{authorization:`Bearer ${localStorage.getItem("token")}`}})}consultarCompetencias(){return this.http.get("http://localhost:3000/alimentador/lista",{headers:{authorization:`Bearer ${localStorage.getItem("token")}`}})}};t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=d({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();function $(i,t){if(i&1&&m(0),i&2){let T=_();g(" Arquivos para a compet\xEAncia ",T.competencia," carregados. ")}}var O=(()=>{let t=class t{constructor(o,e){this.messageService=o,this.uploaderService=e,this.competencia="",this.formData=new FormData,this.competencias=[]}ngOnInit(){this.uploaderService.consultarCompetencias().subscribe(o=>{this.competencias=o,console.log(this.competencias)})}checkFile(o){let e=o.currentFiles[0].name;if(e.startsWith("DIMP_PORTAL_")){let n=e.slice(-6,-4),a=e.slice(-10,-6);this.competencia=`${n}-${a}`,this.formData.append("file",o.currentFiles[0],e)}}onUpload(o){console.log("chapolim",o),this.uploaderService.enviarDimp(this.formData,this.competencia).subscribe(e=>console.log(e)),this.messageService.add({severity:"info",summary:"File Uploaded",detail:""})}};t.\u0275fac=function(e){return new(e||t)(l(I),l(y))},t.\u0275cmp=f({type:t,selectors:[["app-uploader"]],standalone:!0,features:[U([]),S],decls:4,vars:1,consts:[["method","post",3,"onSelect","onUpload","multiple"],["pTemplate","content"],[3,"click"]],template:function(e,n){e&1&&(c(0,"p-fileUpload",0),p("onSelect",function(r){return n.checkFile(r)})("onUpload",function(r){return n.onUpload(r)}),h(1,$,1,1,"ng-template",1),s(),c(2,"button",2),p("click",function(){return n.onUpload("$event")}),m(3,"cirki"),s()),e&2&&v("multiple",!1)},dependencies:[b,D,k,F]});let i=t;return i})();export{O as UploaderComponent};
